<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒãƒã‚¤ã®å¡”</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 800px;
            width: 100%;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .controls button, .controls select {
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        button {
            background: #667eea;
            color: white;
        }
        
        button:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        select {
            background: white;
            border: 2px solid #667eea;
            color: #333;
        }
        
        .info {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .info-item {
            padding: 10px;
            background: #f7fafc;
            border-radius: 10px;
            min-width: 100px;
        }
        
        .info-label {
            font-size: 14px;
            color: #718096;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }
        
        .game-area {
            position: relative;
            height: 300px;
            margin: 20px 0;
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
        }
        
        .base {
            position: absolute;
            bottom: 20px;
            height: 10px;
            width: 100%;
            background: #4a5568;
            border-radius: 5px;
        }
        
        .tower {
            position: absolute;
            bottom: 30px;
            width: 33.33%;
            height: 250px;
            display: flex;
            flex-direction: column-reverse;
            align-items: center;
            cursor: pointer;
            transition: background 0.3s;
            border-radius: 10px;
        }
        
        .tower:hover {
            background: rgba(102, 126, 234, 0.1);
        }
        
        .tower.selected {
            background: rgba(102, 126, 234, 0.2);
        }
        
        .tower:nth-child(2) { left: 0; }
        .tower:nth-child(3) { left: 33.33%; }
        .tower:nth-child(4) { left: 66.66%; }
        
        .pole {
            position: absolute;
            width: 4px;
            height: 200px;
            background: #8B4513;
            left: 50%;
            transform: translateX(-50%);
            bottom: 30px;
            border-radius: 2px;
        }
        
        .disk {
            height: 30px;
            border-radius: 15px;
            margin: 2px 0;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .disk:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .disk.moving {
            animation: pulse 0.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .win-message {
            text-align: center;
            font-size: 24px;
            color: #48bb78;
            font-weight: bold;
            margin-top: 20px;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .instructions {
            background: #f7fafc;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .instructions h3 {
            color: #4a5568;
            margin-bottom: 10px;
        }
        
        .instructions p {
            color: #718096;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—¼ ãƒãƒã‚¤ã®å¡” ğŸ—¼</h1>
        
        <div class="controls">
            <select id="diskCount">
                <option value="3">3æš</option>
                <option value="4">4æš</option>
                <option value="5">5æš</option>
                <option value="6">6æš</option>
                <option value="7">7æš</option>
            </select>
            <button id="newGame">æ–°ã—ã„ã‚²ãƒ¼ãƒ </button>
            <button id="autoSolve">è‡ªå‹•è§£æ±º</button>
            <button id="reset">ãƒªã‚»ãƒƒãƒˆ</button>
        </div>
        
        <div class="info">
            <div class="info-item">
                <div class="info-label">ç§»å‹•å›æ•°</div>
                <div class="info-value" id="moves">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">æœ€å°å›æ•°</div>
                <div class="info-value" id="minMoves">7</div>
            </div>
            <div class="info-item">
                <div class="info-label">çµŒéæ™‚é–“</div>
                <div class="info-value" id="time">0:00</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="base"></div>
            <div class="tower" data-tower="0">
                <div class="pole"></div>
            </div>
            <div class="tower" data-tower="1">
                <div class="pole"></div>
            </div>
            <div class="tower" data-tower="2">
                <div class="pole"></div>
            </div>
        </div>
        
        <div id="message"></div>
        
        <div class="instructions">
            <h3>éŠã³æ–¹</h3>
            <p>
                <strong>ã€ã‚²ãƒ¼ãƒ ã®ç›®çš„ã€‘</strong><br>
                3æœ¬ã®æ£’ãŒã‚ã‚Šã€ä¸€ç•ªå·¦ã®æ£’ï¼ˆå‡ºç™ºç”¨ã®æ£’ï¼‰ã«ç©ã¾ã‚ŒãŸå††ç›¤ã‚’ã€ã™ã¹ã¦ä¸€ç•ªå³ã®æ£’ï¼ˆç›®æ¨™ã®æ£’ï¼‰ã«ç§»å‹•ã•ã›ã‚‹ã“ã¨ãŒç›®çš„ã§ã™ã€‚<br><br>
                
                <strong>ã€åŸºæœ¬ãƒ«ãƒ¼ãƒ«ã€‘</strong><br>
                1. å††ç›¤ã¯1æšãšã¤ã—ã‹å‹•ã‹ã›ã¾ã›ã‚“ã€‚<br>
                2. å°ã•ã„å††ç›¤ã®ä¸Šã«å¤§ãã„å††ç›¤ã‚’ç½®ãã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚<br>
                3. çœŸã‚“ä¸­ã®æ£’ï¼ˆä½œæ¥­ç”¨ã®æ£’ï¼‰ã‚‚è‡ªç”±ã«ä½¿ãˆã¾ã™ãŒã€ãã“ã§ã‚‚ãƒ«ãƒ¼ãƒ«2ã¯å®ˆã‚‰ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚<br>
                4. æœ€å°æ‰‹æ•°ã¯ã€Œ2^n - 1ã€å›ï¼ˆn=å††ç›¤ã®æšæ•°ï¼‰ã§ã™ã€‚<br><br>
                
                <strong>ã€æ“ä½œæ–¹æ³•ã€‘</strong><br>
                <strong>â—† æ‰‹å‹•ã§éŠã¶å ´åˆï¼š</strong><br>
                1. ç§»å‹•ã—ãŸã„å††ç›¤ãŒã‚ã‚‹å¡”ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆèƒŒæ™¯ãŒè–„ç´«è‰²ã«ãªã‚Šé¸æŠçŠ¶æ…‹ã«ãªã‚Šã¾ã™ï¼‰<br>
                2. ç§»å‹•å…ˆã®å¡”ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆãƒ«ãƒ¼ãƒ«ã«å¾“ã£ã¦å††ç›¤ãŒç§»å‹•ã—ã¾ã™ï¼‰<br>
                3. ç§»å‹•ã§ããªã„å ´åˆï¼ˆå¤§ãã„å††ç›¤ã‚’å°ã•ã„å††ç›¤ã®ä¸Šã«ç½®ã“ã†ã¨ã—ãŸå ´åˆãªã©ï¼‰ã¯ä½•ã‚‚èµ·ã“ã‚Šã¾ã›ã‚“<br>
                4. é¸æŠã‚’è§£é™¤ã—ãŸã„å ´åˆã¯ã€åŒã˜å¡”ã‚’ã‚‚ã†ä¸€åº¦ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™<br><br>
                
                <strong>â—† ã‚²ãƒ¼ãƒ ã®é–‹å§‹æ–¹æ³•ï¼š</strong><br>
                1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ã€Œhanoi.htmlã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã<br>
                2. ä¸Šéƒ¨ã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‹ã‚‰å††ç›¤ã®æšæ•°ã‚’é¸æŠï¼ˆ3ã€œ7æšï¼‰<br>
                3. ã€Œæ–°ã—ã„ã‚²ãƒ¼ãƒ ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚¹ã‚¿ãƒ¼ãƒˆ<br>
                4. å·¦ã®å¡”ã‹ã‚‰å³ã®å¡”ã¸å…¨ã¦ã®å††ç›¤ã‚’ç§»å‹•ã•ã›ã‚‹<br><br>
                
                <strong>â—† ç”»é¢ã®è¦‹æ–¹ï¼š</strong><br>
                â€¢ ç§»å‹•å›æ•°ï¼šç¾åœ¨ã¾ã§ã«å††ç›¤ã‚’å‹•ã‹ã—ãŸå›æ•°<br>
                â€¢ æœ€å°å›æ•°ï¼šç†è«–ä¸Šã®æœ€å°ç§»å‹•å›æ•°<br>
                â€¢ çµŒéæ™‚é–“ï¼šã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰ã®æ™‚é–“<br>
                â€¢ å††ç›¤ã®è‰²ï¼šã‚µã‚¤ã‚ºã”ã¨ã«ç•°ãªã‚‹è‰²ã§è¡¨ç¤º<br>
                â€¢ å¡”ã«ãƒã‚¦ã‚¹ã‚’ä¹—ã›ã‚‹ã¨è–„ãå…‰ã‚Šã¾ã™<br><br>
                
                <strong>ã€æ©Ÿèƒ½èª¬æ˜ã€‘</strong><br>
                â€¢ <strong>æšæ•°é¸æŠ</strong>ï¼š3ã€œ7æšã‹ã‚‰é›£æ˜“åº¦ã‚’é¸ã¹ã¾ã™<br>
                â€¢ <strong>æ–°ã—ã„ã‚²ãƒ¼ãƒ </strong>ï¼šæœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—ã¾ã™<br>
                â€¢ <strong>è‡ªå‹•è§£æ±º</strong>ï¼šã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãŒæœ€é©è§£ã‚’å®Ÿæ¼”ã—ã¾ã™<br>
                â€¢ <strong>ãƒªã‚»ãƒƒãƒˆ</strong>ï¼šç¾åœ¨ã®è¨­å®šã§æœ€åˆã«æˆ»ã—ã¾ã™<br><br>
                
                <strong>ã€æ”»ç•¥ã®ãƒ’ãƒ³ãƒˆã€‘</strong><br>
                â€¢ å¥‡æ•°æšï¼šæœ€åˆã®ä¸€æ‰‹ã¯å³ã®å¡”ã¸<br>
                â€¢ å¶æ•°æšï¼šæœ€åˆã®ä¸€æ‰‹ã¯ä¸­å¤®ã®å¡”ã¸<br>
                â€¢ å°ã•ã„å††ç›¤ã‚’é »ç¹ã«å‹•ã‹ã™ã“ã¨ãŒã‚³ãƒ„ã§ã™
            </p>
        </div>
    </div>
    
    <script>
        class HanoiGame {
            constructor() {
                this.towers = [[], [], []];
                this.moves = 0;
                this.selectedTower = null;
                this.diskCount = 3;
                this.startTime = null;
                this.timerInterval = null;
                this.isAutoSolving = false;
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.newGame();
            }
            
            setupEventListeners() {
                document.getElementById('newGame').addEventListener('click', () => this.newGame());
                document.getElementById('reset').addEventListener('click', () => this.reset());
                document.getElementById('autoSolve').addEventListener('click', () => this.autoSolve());
                document.getElementById('diskCount').addEventListener('change', (e) => {
                    this.diskCount = parseInt(e.target.value);
                    this.newGame();
                });
                
                document.querySelectorAll('.tower').forEach(tower => {
                    tower.addEventListener('click', (e) => {
                        if (!this.isAutoSolving) {
                            const towerIndex = parseInt(tower.dataset.tower);
                            this.handleTowerClick(towerIndex);
                        }
                    });
                });
            }
            
            newGame() {
                this.towers = [[], [], []];
                this.moves = 0;
                this.selectedTower = null;
                this.isAutoSolving = false;
                
                for (let i = this.diskCount; i > 0; i--) {
                    this.towers[0].push(i);
                }
                
                this.updateDisplay();
                this.updateMinMoves();
                this.startTimer();
                document.getElementById('message').innerHTML = '';
                document.getElementById('autoSolve').disabled = false;
            }
            
            reset() {
                this.newGame();
            }
            
            startTimer() {
                if (this.timerInterval) {
                    clearInterval(this.timerInterval);
                }
                this.startTime = Date.now();
                this.timerInterval = setInterval(() => {
                    const elapsed = Math.floor((Date.now() - this.startTime) / 1000);
                    const minutes = Math.floor(elapsed / 60);
                    const seconds = elapsed % 60;
                    document.getElementById('time').textContent = 
                        `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            }
            
            handleTowerClick(towerIndex) {
                if (this.selectedTower === null) {
                    if (this.towers[towerIndex].length > 0) {
                        this.selectedTower = towerIndex;
                        document.querySelectorAll('.tower')[towerIndex].classList.add('selected');
                    }
                } else {
                    if (this.canMove(this.selectedTower, towerIndex)) {
                        this.moveDisk(this.selectedTower, towerIndex);
                        this.moves++;
                        this.updateDisplay();
                        
                        if (this.checkWin()) {
                            this.handleWin();
                        }
                    }
                    document.querySelectorAll('.tower').forEach(t => t.classList.remove('selected'));
                    this.selectedTower = null;
                }
            }
            
            canMove(from, to) {
                if (from === to) return false;
                if (this.towers[from].length === 0) return false;
                if (this.towers[to].length === 0) return true;
                return this.towers[from][this.towers[from].length - 1] < 
                       this.towers[to][this.towers[to].length - 1];
            }
            
            moveDisk(from, to) {
                const disk = this.towers[from].pop();
                this.towers[to].push(disk);
            }
            
            checkWin() {
                return this.towers[2].length === this.diskCount;
            }
            
            handleWin() {
                clearInterval(this.timerInterval);
                const minMoves = Math.pow(2, this.diskCount) - 1;
                const efficiency = Math.round((minMoves / this.moves) * 100);
                document.getElementById('message').innerHTML = 
                    `<div class="win-message">
                        ğŸ‰ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ ğŸ‰<br>
                        ${this.moves}å›ã§å®Œæˆã—ã¾ã—ãŸï¼<br>
                        åŠ¹ç‡: ${efficiency}%
                    </div>`;
            }
            
            updateDisplay() {
                document.getElementById('moves').textContent = this.moves;
                
                document.querySelectorAll('.tower').forEach((towerEl, towerIndex) => {
                    const disks = towerEl.querySelectorAll('.disk');
                    disks.forEach(disk => disk.remove());
                    
                    this.towers[towerIndex].forEach(diskSize => {
                        const disk = document.createElement('div');
                        disk.className = 'disk';
                        disk.style.width = `${diskSize * 30 + 40}px`;
                        disk.style.background = this.getDiskColor(diskSize);
                        towerEl.appendChild(disk);
                    });
                });
            }
            
            getDiskColor(size) {
                const colors = [
                    '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', 
                    '#FFEAA7', '#DDA0DD', '#98D8C8', '#F7DC6F'
                ];
                return colors[size - 1] || '#667eea';
            }
            
            updateMinMoves() {
                const minMoves = Math.pow(2, this.diskCount) - 1;
                document.getElementById('minMoves').textContent = minMoves;
            }
            
            async autoSolve() {
                if (this.isAutoSolving) return;
                
                this.isAutoSolving = true;
                document.getElementById('autoSolve').disabled = true;
                this.newGame();
                
                await this.sleep(500);
                await this.solveHanoi(this.diskCount, 0, 2, 1);
                
                this.isAutoSolving = false;
                this.handleWin();
            }
            
            async solveHanoi(n, from, to, aux) {
                if (n === 1) {
                    if (this.canMove(from, to)) {
                        this.moveDisk(from, to);
                        this.moves++;
                        this.updateDisplay();
                        await this.sleep(300);
                    }
                    return;
                }
                
                await this.solveHanoi(n - 1, from, aux, to);
                await this.solveHanoi(1, from, to, aux);
                await this.solveHanoi(n - 1, aux, to, from);
            }
            
            sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }
        
        new HanoiGame();
    </script>
</body>
</html>