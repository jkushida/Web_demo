<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨æ¢ç´¢ vs ãƒ“ãƒ¼ãƒ æ¢ç´¢ - è¨ˆç®—é‡ã®å¯è¦–åŒ–</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .node {
            transition: all 0.3s ease;
        }
        .node.explored {
            animation: pulse 0.5s;
        }
        .node.pruned {
            opacity: 0.3;
        }
        .node.best {
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.8);
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .tree-line {
            stroke: #cbd5e1;
            stroke-width: 1;
            fill: none;
        }
        .tree-line.active {
            stroke: #3b82f6;
            stroke-width: 2;
        }
        .tree-line.best-path {
            stroke: #22c55e;
            stroke-width: 3;
        }
    </style>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-7xl mx-auto">
        <h1 class="text-4xl font-bold text-center mb-2 text-gray-800">å…¨æ¢ç´¢ vs ãƒ“ãƒ¼ãƒ æ¢ç´¢</h1>
        <p class="text-center text-gray-600 mb-8">ãªãœãƒ“ãƒ¼ãƒ æ¢ç´¢ãŒå¿…è¦ãªã®ã‹ã€è¨ˆç®—é‡ã®çˆ†ç™ºçš„å¢—åŠ ã‚’è¦³å¯Ÿã—ã¦ã¿ã¾ã—ã‚‡ã†</p>
        
        <div class="grid lg:grid-cols-2 gap-6 mb-6">
            <!-- å·¦å´: å…¨æ¢ç´¢ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-bold mb-4 text-gray-800">ğŸŒ³ å…¨æ¢ç´¢ï¼ˆå®Œå…¨æ¢ç´¢ï¼‰</h2>
                
                <div class="bg-red-50 border-l-4 border-red-400 p-4 mb-4">
                    <h3 class="font-bold text-red-800 mb-2">âš ï¸ è¨ˆç®—é‡ã®çˆ†ç™º</h3>
                    <div class="text-sm text-gray-700">
                        <p class="mb-2">åˆ†å²ä¿‚æ•° b = <span id="branchingFactor">10</span>ã€æ·±ã• d = <span id="fullDepth">3</span> ã®å ´åˆï¼š</p>
                        <ul class="space-y-1">
                            <li>â€¢ æ·±ã•1: <strong>10</strong> ãƒãƒ¼ãƒ‰</li>
                            <li>â€¢ æ·±ã•2: <strong>100</strong> ãƒãƒ¼ãƒ‰</li>
                            <li>â€¢ æ·±ã•3: <strong>1,000</strong> ãƒãƒ¼ãƒ‰</li>
                            <li id="fullNodes" class="text-red-600 font-bold">åˆè¨ˆ: 1,111 ãƒãƒ¼ãƒ‰æ¢ç´¢</li>
                        </ul>
                    </div>
                </div>
                
                <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-4">
                    <h3 class="font-bold text-blue-800 mb-2">âœ… åˆ©ç‚¹</h3>
                    <ul class="text-sm text-gray-700 space-y-1">
                        <li>â€¢ <strong>æœ€é©è§£ã‚’ä¿è¨¼</strong>: å…¨ã¦ã®å¯èƒ½æ€§ã‚’æ¢ç´¢</li>
                        <li>â€¢ <strong>å®Œå…¨ãªæƒ…å ±</strong>: è¦‹é€ƒã—ãŒãªã„</li>
                        <li>â€¢ <strong>ç†è«–çš„ã«å®Œç’§</strong>: æ•°å­¦çš„ã«æœ€è‰¯ã®æ‰‹</li>
                    </ul>
                </div>
                
                <div class="bg-gray-50 border-l-4 border-gray-400 p-4">
                    <h3 class="font-bold text-gray-800 mb-2">âŒ æ¬ ç‚¹</h3>
                    <ul class="text-sm text-gray-700 space-y-1">
                        <li>â€¢ <strong>è¨ˆç®—æ™‚é–“</strong>: O(b^d) ã®æŒ‡æ•°é–¢æ•°çš„å¢—åŠ </li>
                        <li>â€¢ <strong>ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡</strong>: å…¨ãƒãƒ¼ãƒ‰ã‚’ä¿æŒ</li>
                        <li>â€¢ <strong>å®Ÿç”¨æ€§</strong>: æ·±ã•5ä»¥ä¸Šã¯ç¾å®Ÿçš„ã«ä¸å¯èƒ½</li>
                    </ul>
                </div>
                
                <div class="mt-4">
                    <div id="fullSearchTree" class="relative bg-gray-50 rounded-lg p-4 h-64 overflow-auto">
                        <svg id="fullTreeSvg" class="absolute top-0 left-0"></svg>
                        <div id="fullTreeNodes" class="relative"></div>
                    </div>
                    <div class="mt-2 text-center text-sm text-gray-600">
                        æ¢ç´¢ãƒãƒ¼ãƒ‰æ•°: <span id="fullSearchCount" class="font-bold">0</span>
                    </div>
                </div>
            </div>
            
            <!-- å³å´: ãƒ“ãƒ¼ãƒ æ¢ç´¢ -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-bold mb-4 text-gray-800">ğŸ¯ ãƒ“ãƒ¼ãƒ æ¢ç´¢</h2>
                
                <div class="bg-green-50 border-l-4 border-green-400 p-4 mb-4">
                    <h3 class="font-bold text-green-800 mb-2">ğŸ’¡ åŠ¹ç‡çš„ãªæ¢ç´¢</h3>
                    <div class="text-sm text-gray-700">
                        <p class="mb-2">ãƒ“ãƒ¼ãƒ å¹… k = <span id="beamWidth">3</span>ã€æ·±ã• d = <span id="beamDepth">3</span> ã®å ´åˆï¼š</p>
                        <ul class="space-y-1">
                            <li>â€¢ æ·±ã•1: <strong>10</strong> â†’ ä¸Šä½3ã‚’é¸æŠ</li>
                            <li>â€¢ æ·±ã•2: <strong>30</strong> â†’ ä¸Šä½3ã‚’é¸æŠ</li>
                            <li>â€¢ æ·±ã•3: <strong>30</strong> â†’ ä¸Šä½3ã‚’é¸æŠ</li>
                            <li id="beamNodes" class="text-green-600 font-bold">åˆè¨ˆ: 70 ãƒãƒ¼ãƒ‰æ¢ç´¢ï¼ˆ93.7% å‰Šæ¸›ï¼‰</li>
                        </ul>
                    </div>
                </div>
                
                <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-4">
                    <h3 class="font-bold text-blue-800 mb-2">âœ… åˆ©ç‚¹</h3>
                    <ul class="text-sm text-gray-700 space-y-1">
                        <li>â€¢ <strong>é«˜é€Ÿ</strong>: O(kÃ—bÃ—d) ã®ç·šå½¢çš„å¢—åŠ </li>
                        <li>â€¢ <strong>å®Ÿç”¨çš„</strong>: æ·±ã„æ¢ç´¢ãŒå¯èƒ½</li>
                        <li>â€¢ <strong>ãƒ¡ãƒ¢ãƒªåŠ¹ç‡</strong>: kå€‹ã®ãƒãƒ¼ãƒ‰ã®ã¿ä¿æŒ</li>
                    </ul>
                </div>
                
                <div class="bg-gray-50 border-l-4 border-gray-400 p-4">
                    <h3 class="font-bold text-gray-800 mb-2">âš ï¸ æ¬ ç‚¹</h3>
                    <ul class="text-sm text-gray-700 space-y-1">
                        <li>â€¢ <strong>å±€æ‰€æœ€é©</strong>: æœ€é©è§£ã‚’è¦‹é€ƒã™å¯èƒ½æ€§</li>
                        <li>â€¢ <strong>ãƒ“ãƒ¼ãƒ å¹…ä¾å­˜</strong>: kãŒå°ã•ã„ã¨ç²¾åº¦ä½ä¸‹</li>
                        <li>â€¢ <strong>è²ªæ¬²çš„</strong>: æ—©æœŸã®æåˆˆã‚Šãƒªã‚¹ã‚¯</li>
                    </ul>
                </div>
                
                <div class="mt-4">
                    <div id="beamSearchTree" class="relative bg-gray-50 rounded-lg p-4 h-64 overflow-auto">
                        <svg id="beamTreeSvg" class="absolute top-0 left-0"></svg>
                        <div id="beamTreeNodes" class="relative"></div>
                    </div>
                    <div class="mt-2 text-center text-sm text-gray-600">
                        æ¢ç´¢ãƒãƒ¼ãƒ‰æ•°: <span id="beamSearchCount" class="font-bold">0</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4 text-gray-800">âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š</h2>
            
            <div class="grid md:grid-cols-3 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">åˆ†å²ä¿‚æ•° (å„ãƒãƒ¼ãƒ‰ã®å­æ•°)</label>
                    <input type="range" id="branchingSlider" min="2" max="15" value="10" class="w-full">
                    <div class="text-center text-sm text-gray-600">å€¤: <span id="branchingValue">10</span></div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">æ¢ç´¢ã®æ·±ã•</label>
                    <input type="range" id="depthSlider" min="1" max="5" value="3" class="w-full">
                    <div class="text-center text-sm text-gray-600">å€¤: <span id="depthValue">3</span></div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ãƒ“ãƒ¼ãƒ å¹…</label>
                    <input type="range" id="beamSlider" min="1" max="10" value="3" class="w-full">
                    <div class="text-center text-sm text-gray-600">å€¤: <span id="beamValue">3</span></div>
                </div>
            </div>
            
            <div class="flex gap-4">
                <button id="simulateBtn" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                    æ¢ç´¢ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
                </button>
                <button id="resetBtn" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">
                    ãƒªã‚»ãƒƒãƒˆ
                </button>
            </div>
        </div>
        
        <!-- æ¯”è¼ƒã‚°ãƒ©ãƒ• -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-bold mb-4 text-gray-800">ğŸ“Š è¨ˆç®—é‡ã®æ¯”è¼ƒ</h2>
            
            <div class="grid lg:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-bold mb-2 text-gray-700">æ¢ç´¢ãƒãƒ¼ãƒ‰æ•°ã®å¢—åŠ </h3>
                    <canvas id="complexityChart"></canvas>
                </div>
                <div>
                    <h3 class="text-lg font-bold mb-2 text-gray-700">å®Ÿéš›ã®ã‚²ãƒ¼ãƒ ï¼ˆã‚ªã‚»ãƒ­ï¼‰ã§ã®æ¯”è¼ƒ</h3>
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                        <h4 class="font-bold text-yellow-800 mb-2">ğŸ® ã‚ªã‚»ãƒ­ã®å ´åˆ</h4>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li>â€¢ å¹³å‡åˆ†å²ä¿‚æ•°: <strong>ç´„10æ‰‹</strong></li>
                            <li>â€¢ æ·±ã•6æ‰‹å…ˆã¾ã§èª­ã‚€å ´åˆ:</li>
                            <li class="ml-4">- å…¨æ¢ç´¢: <strong>1,111,111</strong> ãƒãƒ¼ãƒ‰</li>
                            <li class="ml-4">- ãƒ“ãƒ¼ãƒ æ¢ç´¢(k=5): <strong>300</strong> ãƒãƒ¼ãƒ‰</li>
                            <li class="ml-4 text-green-600 font-bold">â†’ 99.97% ã®å‰Šæ¸›ï¼</li>
                        </ul>
                    </div>
                    
                    <div class="mt-4 bg-blue-50 border-l-4 border-blue-400 p-4">
                        <h4 class="font-bold text-blue-800 mb-2">â™Ÿï¸ ãƒã‚§ã‚¹ã®å ´åˆ</h4>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li>â€¢ å¹³å‡åˆ†å²ä¿‚æ•°: <strong>ç´„35æ‰‹</strong></li>
                            <li>â€¢ æ·±ã•4æ‰‹å…ˆã¾ã§èª­ã‚€å ´åˆ:</li>
                            <li class="ml-4">- å…¨æ¢ç´¢: <strong>1,500,625</strong> ãƒãƒ¼ãƒ‰</li>
                            <li class="ml-4">- ãƒ“ãƒ¼ãƒ æ¢ç´¢(k=10): <strong>1,400</strong> ãƒãƒ¼ãƒ‰</li>
                            <li class="ml-4 text-green-600 font-bold">â†’ 99.91% ã®å‰Šæ¸›ï¼</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 bg-gradient-to-r from-blue-50 to-green-50 p-4 rounded-lg">
                <h3 class="font-bold text-gray-800 mb-2">ğŸ’¡ çµè«–</h3>
                <p class="text-sm text-gray-700">
                    <strong>å…¨æ¢ç´¢ã¯ç†è«–çš„ã«ã¯æœ€é©</strong>ã§ã™ãŒã€ç¾å®Ÿçš„ãªæ™‚é–“å†…ã§è¨ˆç®—ã§ãã¾ã›ã‚“ã€‚
                    <strong>ãƒ“ãƒ¼ãƒ æ¢ç´¢ã¯æº–æœ€é©è§£</strong>ã‚’é«˜é€Ÿã«è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã€å®Ÿç”¨çš„ã§ã™ã€‚
                    æ·±ã•10ä»¥ä¸Šã‚’æ¢ç´¢ã™ã‚‹å ´åˆã€å…¨æ¢ç´¢ã¯å®‡å®™ã®å¹´é½¢ã‚ˆã‚Šã‚‚é•·ã„æ™‚é–“ãŒã‹ã‹ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ãŒã€
                    ãƒ“ãƒ¼ãƒ æ¢ç´¢ãªã‚‰æ•°ç§’ã§å®Œäº†ã—ã¾ã™ã€‚
                </p>
            </div>
        </div>
    </div>

    <script>
        // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        let branchingFactor = 10;
        let searchDepth = 3;
        let beamWidth = 3;
        let isSimulating = false;
        
        // DOMè¦ç´ 
        const branchingSlider = document.getElementById('branchingSlider');
        const depthSlider = document.getElementById('depthSlider');
        const beamSlider = document.getElementById('beamSlider');
        const branchingValue = document.getElementById('branchingValue');
        const depthValue = document.getElementById('depthValue');
        const beamValue = document.getElementById('beamValue');
        const simulateBtn = document.getElementById('simulateBtn');
        const resetBtn = document.getElementById('resetBtn');
        
        // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ
        branchingSlider.addEventListener('input', (e) => {
            branchingFactor = parseInt(e.target.value);
            branchingValue.textContent = branchingFactor;
            updateCalculations();
        });
        
        depthSlider.addEventListener('input', (e) => {
            searchDepth = parseInt(e.target.value);
            depthValue.textContent = searchDepth;
            updateCalculations();
        });
        
        beamSlider.addEventListener('input', (e) => {
            beamWidth = parseInt(e.target.value);
            beamValue.textContent = beamWidth;
            updateCalculations();
        });
        
        // è¨ˆç®—é‡ã®æ›´æ–°
        function updateCalculations() {
            // å…¨æ¢ç´¢ã®ãƒãƒ¼ãƒ‰æ•°è¨ˆç®—
            let fullNodes = 0;
            let fullBreakdown = [];
            for (let d = 1; d <= searchDepth; d++) {
                const nodesAtDepth = Math.pow(branchingFactor, d);
                fullNodes += nodesAtDepth;
                fullBreakdown.push(`æ·±ã•${d}: <strong>${nodesAtDepth.toLocaleString()}</strong> ãƒãƒ¼ãƒ‰`);
            }
            
            // ãƒ“ãƒ¼ãƒ æ¢ç´¢ã®ãƒãƒ¼ãƒ‰æ•°è¨ˆç®—
            let beamNodes = 0;
            let beamBreakdown = [];
            for (let d = 1; d <= searchDepth; d++) {
                const nodesAtDepth = d === 1 ? branchingFactor : beamWidth * branchingFactor;
                beamNodes += nodesAtDepth;
                if (d === 1) {
                    beamBreakdown.push(`æ·±ã•${d}: <strong>${nodesAtDepth}</strong> â†’ ä¸Šä½${beamWidth}ã‚’é¸æŠ`);
                } else {
                    beamBreakdown.push(`æ·±ã•${d}: <strong>${nodesAtDepth}</strong> â†’ ä¸Šä½${beamWidth}ã‚’é¸æŠ`);
                }
            }
            
            const reduction = ((1 - beamNodes / fullNodes) * 100).toFixed(1);
            
            // UIæ›´æ–°
            document.getElementById('branchingFactor').textContent = branchingFactor;
            document.getElementById('fullDepth').textContent = searchDepth;
            document.getElementById('beamWidth').textContent = beamWidth;
            document.getElementById('beamDepth').textContent = searchDepth;
            
            // ãƒãƒ¼ãƒ‰æ•°ã®è©³ç´°æ›´æ–°
            const fullList = document.querySelector('.bg-red-50 ul');
            fullList.innerHTML = fullBreakdown.join('</li><li>â€¢ ') + '</li><li id="fullNodes" class="text-red-600 font-bold">åˆè¨ˆ: ' + fullNodes.toLocaleString() + ' ãƒãƒ¼ãƒ‰æ¢ç´¢</li>';
            
            const beamList = document.querySelector('.bg-green-50 ul');
            beamList.innerHTML = beamBreakdown.join('</li><li>â€¢ ') + '</li><li id="beamNodes" class="text-green-600 font-bold">åˆè¨ˆ: ' + beamNodes.toLocaleString() + ' ãƒãƒ¼ãƒ‰æ¢ç´¢ï¼ˆ' + reduction + '% å‰Šæ¸›ï¼‰</li>';
            
            updateChart();
        }
        
        // ã‚°ãƒ©ãƒ•ã®æ›´æ–°
        let complexityChart = null;
        
        function updateChart() {
            const ctx = document.getElementById('complexityChart').getContext('2d');
            
            const depths = Array.from({length: 10}, (_, i) => i + 1);
            const fullSearchData = depths.map(d => {
                let nodes = 0;
                for (let i = 1; i <= d; i++) {
                    nodes += Math.pow(branchingFactor, i);
                }
                return nodes;
            });
            
            const beamSearchData = depths.map(d => {
                let nodes = 0;
                for (let i = 1; i <= d; i++) {
                    nodes += i === 1 ? branchingFactor : beamWidth * branchingFactor;
                }
                return nodes;
            });
            
            if (complexityChart) {
                complexityChart.destroy();
            }
            
            complexityChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: depths,
                    datasets: [{
                        label: 'å…¨æ¢ç´¢',
                        data: fullSearchData,
                        borderColor: 'rgb(239, 68, 68)',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.1
                    }, {
                        label: 'ãƒ“ãƒ¼ãƒ æ¢ç´¢',
                        data: beamSearchData,
                        borderColor: 'rgb(34, 197, 94)',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'æ·±ã•ã«å¯¾ã™ã‚‹æ¢ç´¢ãƒãƒ¼ãƒ‰æ•°'
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: 'æ¢ç´¢ã®æ·±ã•'
                            }
                        },
                        y: {
                            display: true,
                            title: {
                                display: true,
                                text: 'æ¢ç´¢ãƒãƒ¼ãƒ‰æ•°'
                            },
                            type: 'logarithmic'
                        }
                    }
                }
            });
        }
        
        // æœ¨æ§‹é€ ã®æç”»
        function drawTree(containerId, svgId, nodesId, isBeamSearch) {
            const container = document.getElementById(containerId);
            const svg = document.getElementById(svgId);
            const nodesDiv = document.getElementById(nodesId);
            
            // ã‚¯ãƒªã‚¢
            svg.innerHTML = '';
            nodesDiv.innerHTML = '';
            
            const nodeSize = 20;
            const levelGap = 50;
            const nodeGap = 25;
            
            // ãƒãƒ¼ãƒ‰ã®ä½œæˆ
            let nodeCount = 0;
            const nodes = [];
            
            for (let depth = 0; depth <= Math.min(searchDepth, 4); depth++) {
                const nodesAtDepth = depth === 0 ? 1 : 
                    (isBeamSearch && depth > 1 ? Math.min(beamWidth, Math.pow(branchingFactor, depth)) : 
                     Math.min(Math.pow(branchingFactor, depth), 100));
                
                const y = 20 + depth * levelGap;
                const totalWidth = nodesAtDepth * nodeGap;
                const startX = Math.max(10, (300 - totalWidth) / 2);
                
                for (let i = 0; i < nodesAtDepth; i++) {
                    const x = startX + i * nodeGap;
                    
                    const nodeDiv = document.createElement('div');
                    nodeDiv.className = 'node absolute rounded-full bg-blue-500';
                    nodeDiv.style.width = nodeSize + 'px';
                    nodeDiv.style.height = nodeSize + 'px';
                    nodeDiv.style.left = x + 'px';
                    nodeDiv.style.top = y + 'px';
                    
                    // ãƒ“ãƒ¼ãƒ æ¢ç´¢ã§æåˆˆã‚Šã•ã‚Œã‚‹ãƒãƒ¼ãƒ‰
                    if (isBeamSearch && depth > 0 && i >= beamWidth) {
                        nodeDiv.classList.add('pruned');
                        nodeDiv.classList.remove('bg-blue-500');
                        nodeDiv.classList.add('bg-gray-300');
                    } else {
                        nodeCount++;
                    }
                    
                    nodesDiv.appendChild(nodeDiv);
                    nodes.push({x: x + nodeSize/2, y: y + nodeSize/2, depth: depth, pruned: isBeamSearch && depth > 0 && i >= beamWidth});
                }
            }
            
            // ã‚¨ãƒƒã‚¸ã®æç”»
            nodes.forEach((node, idx) => {
                if (node.depth > 0) {
                    const parentIdx = Math.floor(idx / branchingFactor);
                    if (parentIdx < nodes.length) {
                        const parent = nodes[parentIdx];
                        
                        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                        line.setAttribute('x1', parent.x);
                        line.setAttribute('y1', parent.y);
                        line.setAttribute('x2', node.x);
                        line.setAttribute('y2', node.y);
                        line.classList.add('tree-line');
                        
                        if (node.pruned) {
                            line.style.opacity = '0.3';
                        }
                        
                        svg.appendChild(line);
                    }
                }
            });
            
            // ã‚µã‚¤ã‚ºè¨­å®š
            svg.setAttribute('width', 320);
            svg.setAttribute('height', 20 + (searchDepth + 1) * levelGap);
            
            // ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–°
            if (isBeamSearch) {
                document.getElementById('beamSearchCount').textContent = nodeCount;
            } else {
                document.getElementById('fullSearchCount').textContent = nodeCount;
            }
        }
        
        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        async function simulate() {
            if (isSimulating) return;
            isSimulating = true;
            simulateBtn.disabled = true;
            
            // å…¨æ¢ç´¢ã®æç”»
            drawTree('fullSearchTree', 'fullTreeSvg', 'fullTreeNodes', false);
            
            await new Promise(resolve => setTimeout(resolve, 500));
            
            // ãƒ“ãƒ¼ãƒ æ¢ç´¢ã®æç”»
            drawTree('beamSearchTree', 'beamTreeSvg', 'beamTreeNodes', true);
            
            isSimulating = false;
            simulateBtn.disabled = false;
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        simulateBtn.addEventListener('click', simulate);
        resetBtn.addEventListener('click', () => {
            branchingSlider.value = 10;
            depthSlider.value = 3;
            beamSlider.value = 3;
            branchingFactor = 10;
            searchDepth = 3;
            beamWidth = 3;
            branchingValue.textContent = 10;
            depthValue.textContent = 3;
            beamValue.textContent = 3;
            updateCalculations();
            simulate();
        });
        
        // åˆæœŸåŒ–
        updateCalculations();
        simulate();
    </script>
</body>
</html>